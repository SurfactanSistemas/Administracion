Imports System.Drawing.Imaging
Imports System.IO
Imports System.IO.Ports
Imports System.Runtime.InteropServices
Imports System.Text

Public Class Principal

    Private Sub EmisiónDeEtiquetasToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles EmisiónDeEtiquetasToolStripMenuItem.Click
        With New EmisionEtiquetas
            .Show(Me)
        End With
    End Sub

    Private Sub EmisiónDeEtiquetasDePreenvasadoToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles EmisiónDeEtiquetasDePreenvasadoToolStripMenuItem.Click
        With New EmisionEtiquetaPreenvasado
            .Show(Me)
        End With
    End Sub

    Private Sub Principal_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        '
        ' Determino acciones para cuando es llamado por linea de Comandos.
        '
        If Environment.GetCommandLineArgs.Length > 1 Then

            Dim WPartida As String = Environment.GetCommandLineArgs(1)
            Dim WCantidad As String = Environment.GetCommandLineArgs(2)
            Dim WCantidadEtiq As String = Environment.GetCommandLineArgs(3)
            Dim WTara As String = Environment.GetCommandLineArgs(4)
            Dim WLoteMP As String = Environment.GetCommandLineArgs(5)

            'MsgBox(WLoteMP)

            Me.WindowState = FormWindowState.Minimized
            Me.Hide()

            With New EmisionEtiquetas()

                .WindowState = FormWindowState.Minimized
                .Hide()
                .Show()
                .Focus()

                .txtLote.Text = WPartida
                .txtLote_KeyDown(Nothing, New KeyEventArgs(Keys.Enter))
                .txtCantidad.Text = WCantidad
                .txtCantEtiq.Text = WCantidadEtiq
                .txtTara.Text = WTara
                .txtLoteMP.Text = WLoteMP

                .btnEmitir_Click(Nothing, Nothing)

                .Close()

            End With

            Close()

        End If

    End Sub

    Private Sub PruebaToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles PruebaToolStripMenuItem.Click

        Dim SerialPort1 As New SerialPort

        SerialPort1.PortName = "COM4"
        SerialPort1.Open()


        SerialPort1.Write("^LH0,0^LRN")
        SerialPort1.Write("^XZ")
        SerialPort1.Write("~DGR:SSGFX000.GRF,4785,55,0000000000000000000000000000000000000000000000000000000000000000000000000001400000000000000000000280000000000000000000002A0000000000000000000002A000000000000000000002A0000000000000000000800000000000000000000100000000000000000000001400000000000000000000014000000000000000000001400000000000000000015000000000000000000002A000000000000000000000AA800000000000000000000AA80000000000000000000AA8000000000000000002A8000000000000000000055000000000000000000000550000000000000000000005500000000000000000000550000000000000000005540000000000000000000AA800000000000000000002AAA00000000000000000002AAA0000000000000000002AAA000000000000000008A800000000000000000011500000000000000000000115000000000000000000001150000000000000000000115000000000000000005555400000000000000000AAAA8000000000000000000AEAA8800000000000000000AEAA880000000000000000AEAA88000000000000002A0A80000000000000000054150000000000000000000541500000000000000000005415000000000000000000541500000000000000005515400000000000000000AA2A8000000000000000002A82AA000000000000000002A82AA00000000000000002A82AA000000000000000A8028000000000000000015005000000000000000000110054000000000000000001100540000000000000000110054000000000000005540554000000000000000AA80AA80000000000000000AA80AA80000000000000000AA80AA8000000000000000AA80AA800000000000002A000A800000000000000054001500000000000000000540015000000000000000005400150000000000000000540015000000000000005500154000000000000000AA002A80000000000000002AA000A80000000000000002AA000A8000000000000002AA000A8000000000000088000280000000000000011000050000000000000000110000500000000000000001100005000000000000000110000500000000000005540005540000000000000AA8000AA800000000000000AA8000AA800000000000000AA8000AA80000000000000AA8000AA8000000000002A00002A0000000000000054000054000000000000000540000150000000000000005400001500000000000000540000150000000000005500001540000000000000AA00002A800000000000002AA00002AA00000000000002AA00002AA0000000000002AA00002AA00000000000A800000A800000000000015000001500000000000000150000005400000000000001500000054000000000000150000005400000000005540000055000000000000AA800000AA0000000000000AA800000AA8000000000000AA800000AA800000000000AA800000AA80000000002A0000002A80000000000054000000550000000000000540000001500000000000005400000015000000000000540000001500000000015500150015400000000002AA002A002A8000000000002A8003E000AA000000000002A8003E000AA00000000002A8003E000AA00000000088000E800A80000000000110001D0015000000000000150007F0005400000000000150007F000540000000000150007F0005400000004554407FF04554000000008AA880FFE08AA80000000008AE803FFE08AA80000000008AE803FFE08AA8000000008AE803FFE08AA800000002A000FFE002A800000000054001FFC00550000000000054001FFE00150000000000054001FFE0015000000000054001FFE00150000000155001FFF00154000000002AA003FFE002A80000000002AA003FFE002AA0000000002AA003FFE002AA000000002AA003FFE002AA000000088000FFF0002800000000110001FFE00050000000000110001FFE00054000000000110001FFE0005400000000110001FFE00054000000554405FFF0005500000000AA880BFFE000AA000000000AA0003FFE000AA800000000AA0003FFE000AA80000000AA0003FFE000AA8000002A0000FFE0000A80000000540001FFC00015000000000540001FFC00015000000000540001FFC0001500000000540001FFC00015000001550001FFF0001540000002AA0003FFE0002A800000002A80003FFE0002A800000002A80003FFE0002A80000002A80003FFE0002A800000880000FFE0000280000001100001FFC00005000000001100001FFC00005400000001100001FFC0000540000001100001FFC00005400005540000FFF000455400000AA80001FFE0008AA8000000AA80001FFE0008AA8000000AA80001FFE0008AA800000AA80001FFE0008AA80002A00000FFE00000A8000005400001FFC00001500000005400001FFC00001500000005400001FFC0000150000005400001FFC000015000055000007FF000015400000AA00000FFE00002A8000002AA00000FFA00002A8000002AA00000FFA00002A800002AA00000FFA00002A800088000007FE0000028000011000000FFC00000500000011000000FFC00000540000011000000FFC0000054000011000000FFC000005400154400007FE000005500002A880000FFC00000AA00000AA800000FF800000AA80000AA800000FF800000AA8000AA800000FF800000AA802A0000007FE000000A800054000000FFC00000150000054000000FFC00000150000054000000FFC0000015000054000000FFC000001500550000007FC00000154000AA000000FF8000002A80002AA000000FF8000002AA0002AA000000FF8000002AA002AA000000FF8000002A80880000003F800000028001100000007F0000000500001100000007F0000000540001100000007F000000054001100000007F0000000505540000007FC0000045500AA8000000FF8000008AA000AA8000000FF8000000AA800AA8000000FF8000000AA80AA8000000FF8000000A82A00000003F80000000A805400000007F0000000150005400000007F0000000150005400000007F000000015005400000007F0000000105500000007FC0000001540AA0000000FF80000002A802AA0000000FF80000002AA02AA0000000FF80000002AA2AA0000000FF8000000288800000003F800000002811000000007F0000000050011000000007F0000000050011000000007F000000005011000000007F0000000055400000007FC000000057AA80000000FF80000000AE0AA80000000FF80000000AA0AA80000000FF80000000AAAA80000000FF80000000AA000000003F800000002A54000000007F0000000054054000000007F0000000054054000000007F000000005454000000007F0000000015000000001F80000000552A000000003F00000000AA02A800000003F00000000AA02A800000003F00000000AA2A800000003F000000008A800000003F800000002A15000000007F0000000054015000000007F0000000110015000000007F000000011015000000007F0000000145500000005F80000001548AA0000000BF00000002A808AA00000003E0000000AA808AA00000003E0000000AA88AA00000003E0000000A82A00000001E80000000A805400000003D0000000150005400000001C0000000540005400000001C000000054005400000001C0000000501500000001F000000055002A00000003E0000000AA0002A00000003E0000000AA0002A00000003E0000000AA002A00000003E0000000A80A80000000000000002800150000000000000000500001500000000000000015000015000000000000000150001500000000000000015005500000000000000154000AA000000000000002A80000AA000000000000002A80000AA000000000000002A8000AA000000000000002A802A000000000000000A80005400000000000000150000054000000040000005400000540000000400000054000054000000040000005400150000001F0000005500002A0000003E000000AA000002A0000003E000000AA000002A0000003E000000AA00002A0000003E000000AA000A8000003F8000002A0000150000007F0000005400000150000007F0000011000000150000007F000001100000150000007F0000011040455000007FC000015440808AA00000FF800002A8800808AA00000FF800002A8800808AA00000FF800002A880808AA00000FF800002A88002A000007FA00000A8000005400000FF400001500000005400000FFC00005400000005400000FFC0000540000005400000FFC000054000015000007FC0000550000002A00000FF80000AA00000002A00000FF80000AA00000002A00000FF80000AA0000002A00000FF80000AA00000A800007FE0000280000001500000FFC00005000000000500000FF000015000000000500000FF00001500000000500000FF0000150000015400007FC0001540000002A80000FF80002A800000000AA0000FF80002A880000000AA0000FF80002A88000000AA0000FF80002A8800002A00003F80000A800000005400007F0000150000000005400007F0000150000000005400007F000015000000005400007F0000150000001500007F800015000000002A0000FF00002A0000000002A00003F0000AA0000000002A00003F0000AA000000002A00003F0000AA0000000A80000A00002A00000000150000140000540000000001500001400005400000000015000014000054000000001500001400005400000015500014000154000000002AA000280002A80000000000AA00008000AA80000000000AA00008000AA8000000000AA00008000AA800000002A000000002A8000000000540000000055000000000005400000000550000000000054000000005500000000005400000000550000000015000000001500000000002A000000002A000000000002A80000000AA000000000002A80000000AA00000000002A80000000AA000000000A80000000AA0000000000150000000154000000000001500000001540000000000015000000015400000000001500000001540000000015500000015400000000002AA0000002A8000000000000AA000000AA8000000000000AA000000AA800000000000AA000000AA80000000002A0000002A800000000000540000005500000000000005400000055000000000000054000000550000000000005400000055000000000015000000150000000000002A0000002A00000000000002A0000002A00000000000002A0000002A0000000000002A0000002A00000000000A80000088000000000000150000011000000000000001500000110000000000000015000001100000000000001500000110000000000045500001540000000000008AA00002A800000000000008AA00002A800000000000008AA00002A80000000000008AA00002A8000000000002A00002A00000000000000540000540000000000000005400005400000000000000054000054000000000000005400005400000000000015000055000000000000002A0000AA0000000000000002A0000AA0000000000000002A0000AA000000000000002A0000AA0000000000000A80002A00000000000000150000540000000000000001500015000000000000000015000150000000000000001500015000000000000005500154000000000000000AA002A80000000000000000AA002A80000000000000000AA002A8000000000000000AA002A800000000000002A000A8000000000000000540015000000000000000005400540000000000000000054005400000000000000005400540000000000000015005500000000000000002A00AA000000000000000002A00AA000000000000000002A00AA00000000000000002A00AA000000000000000A80280000000000000000150050000000000000000001500500000000000000000015005000000000000000001500500000000000000045555440000000000000008AAAA8800000000000000008AAAA8800000000000000008AAAA880000000000000008AAAA88000000000000002A0A800000000000000000541500000000000000000005415000000000000000000054150000000000000000005415000000000000000015550000000000000000002AAA00000000000000000002AAA00000000000000000002AAA0000000000000000002AAA00000000000000000AAA000000000000000000155400000000000000000001554000000000000000000015540000000000000000001554000000000000000045540000000000000000008AA800000000000000000008AA800000000000000000008AA80000000000000000008AA8000000000000000002A80000000000000000000550000000000000000000005500000000000000000000055000000000000000000005500000000000000000015000000000000000000002A0000000000000000000002A0000000000000000000002A000000000000000000002A0000000000000000000800000000000000000000100000000000000000000001000000000000000000000010000000000000000000001000000000000000000000000000000000000000000000000000000")
        SerialPort1.Write("^XA")
        SerialPort1.Write("^FT54,248")
        SerialPort1.Write("^CI0")
        SerialPort1.Write("^A0N,56,76^FDPda:^FS")
        SerialPort1.Write("^FT37,133")
        SerialPort1.Write("^A0N,59,80^FDPT-08080/100^FS")
        SerialPort1.Write("^FT52,373")
        SerialPort1.Write("^A0N,56,76^FDNeto:^FS")
        SerialPort1.Write("^FT312,373")
        SerialPort1.Write("^A0N,56,76^FD100 Kg^FS")
        SerialPort1.Write("^FT295,248")
        SerialPort1.Write("^A0N,56,76^FD220000^FS")
        SerialPort1.Write("^FT146,472")
        SerialPort1.Write("^A0N,39,53^FDCod. Seg:^FS")
        SerialPort1.Write("^FT375,472")
        SerialPort1.Write("^A0N,39,53^FD55^FS")
        SerialPort1.Write("^FT189,548")
        SerialPort1.Write("^A0N,39,53^FDPELIGRO^FS")
        SerialPort1.Write("^FO99,695")
        SerialPort1.Write("^BY1,3.0^B3N,N,85,N,N^FDPT-08080-100220000001^FS")
        SerialPort1.Write("^FT75,674")
        SerialPort1.Write("^A0N,135,91^FD^FS")
        SerialPort1.Write("^FT171,674")
        SerialPort1.Write("^A0N,135,91^FDX^FS")
        SerialPort1.Write("^FT259,674")
        SerialPort1.Write("^A0N,135,91^FDX^FS")
        SerialPort1.Write("^FT347,674")
        SerialPort1.Write("^A0N,135,91^FDX^FS")
        SerialPort1.Write("^FT427,674")
        SerialPort1.Write("^A0N,135,91^FDX^FS")
        SerialPort1.Write("^FO62,580")
        SerialPort1.Write("^XGR:SSGFX000.GRF,1,1^FS")
        SerialPort1.Write("^PQ1,0,1,Y")
        SerialPort1.Write("^XZ")
        SerialPort1.Write("^XA")
        SerialPort1.Write("^IDR:SSGFX000.GRF^XZ")

        SerialPort1.Close()

    End Sub

End Class